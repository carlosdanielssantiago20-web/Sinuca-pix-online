<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sinuca Pix Online</title>

<style>
body {
  margin: 0;
  background: radial-gradient(circle at top, #111, #000);
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  touch-action: none;
}

canvas {
  background: radial-gradient(circle, #0f6b3f, #064026);
  border-radius: 20px;
  box-shadow:
    0 0 40px rgba(0,255,150,0.3),
    inset 0 0 25px rgba(0,0,0,0.8);
}
</style>
</head>

<body>

<canvas id="game" width="360" height="640"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const table = {
  left: 30,
  right: canvas.width - 30,
  top: 30,
  bottom: canvas.height - 30
};

let mouse = {x:0,y:0};
let shooting = false;
let turno = "player";

const cueBall = {
  x: canvas.width / 2,
  y: canvas.height - 140,
  r: 10,
  vx: 0,
  vy: 0,
  color: "#ffffff"
};

const balls = [cueBall];

function createBalls() {
  const colors = ["#f00","#00f","#ff0","#f0f","#0ff","#fa0"];
  let startX = canvas.width/2 - 30;
  let startY = 120;

  for(let i=0;i<6;i++){
    balls.push({
      x: startX + i*22,
      y: startY,
      r: 10,
      vx: 0,
      vy: 0,
      color: colors[i]
    });
  }
}
createBalls();

canvas.addEventListener("mousemove", e=>{
  const rect = canvas.getBoundingClientRect();
  mouse.x = e.clientX - rect.left;
  mouse.y = e.clientY - rect.top;
});

canvas.addEventListener("mousedown", ()=>{
  if(turno !== "player") return;
  if(bolasParadas()){
    shooting = true;
  }
});

canvas.addEventListener("mouseup", ()=>{
  if(shooting){
    cueBall.vx = (cueBall.x - mouse.x) * 0.05;
    cueBall.vy = (cueBall.y - mouse.y) * 0.05;
    shooting = false;
    turno = "ia";
  }
});

function bolasParadas(){
  return balls.every(b => Math.hypot(b.vx, b.vy) < 0.1);
}

// ===== IA SIMPLES =====
function iaPlay(){
  let alvo = balls[Math.floor(Math.random()*(balls.length-1))+1];

  const dx = cueBall.x - alvo.x;
  const dy = cueBall.y - alvo.y;

  cueBall.vx = dx * 0.04;
  cueBall.vy = dy * 0.04;
}

// ===== DESENHO DA BOLA =====
function drawBall(ball){
  ctx.beginPath();
  ctx.arc(ball.x+4, ball.y+6, ball.r, 0, Math.PI*2);
  ctx.fillStyle = "rgba(0,0,0,0.35)";
  ctx.fill();

  const g = ctx.createRadialGradient(
    ball.x-4, ball.y-4, ball.r*0.2,
    ball.x, ball.y, ball.r
  );
  g.addColorStop(0,"#fff");
  g.addColorStop(0.3,ball.color);
  g.addColorStop(1,"#000");

  ctx.beginPath();
  ctx.arc(ball.x, ball.y, ball.r, 0, Math.PI*2);
  ctx.fillStyle = g;
  ctx.fill();
}

function update(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  ctx.strokeStyle = "#2b1b0f";
  ctx.lineWidth = 20;
  ctx.strokeRect(
    table.left-10,
    table.top-10,
    table.right-table.left+20,
    table.bottom-table.top+20
  );

  balls.forEach(ball=>{
    ball.x += ball.vx;
    ball.y += ball.vy;

    ball.vx *= 0.99;
    ball.vy *= 0.99;

    if(ball.x-ball.r < table.left || ball.x+ball.r > table.right){
      ball.vx *= -1;
    }
    if(ball.y-ball.r < table.top || ball.y+ball.r > table.bottom){
      ball.vy *= -1;
    }

    drawBall(ball);
  });

  if(shooting){
    ctx.setLineDash([8,8]);
    ctx.strokeStyle = "rgba(255,255,255,0.5)";
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(cueBall.x, cueBall.y);
    ctx.lineTo(mouse.x, mouse.y);
    ctx.stroke();
    ctx.setLineDash([]);
  }

  // TURNO DA IA
  if(turno === "ia" && bolasParadas()){
    setTimeout(()=>{
      iaPlay();
      turno = "player";
    }, 600);
  }

  requestAnimationFrame(update);
}

update();
    </script>
    

</body>
</html>
